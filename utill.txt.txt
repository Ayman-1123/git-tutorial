utility function for version 3 and the code is quite perfect
